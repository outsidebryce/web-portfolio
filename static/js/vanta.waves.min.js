// This file should be downloaded from https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.waves.min.js
// For now, we'll use a CDN link instead of storing it locally 

// Dynamically load Three.js and Vanta
async function initVanta() {
    try {
        // Load Three.js only when needed
        await import('https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js');
        await import('https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.waves.min.js');

        if (window.VANTA) {
            window.vantaEffect = VANTA.WAVES({
                el: "#vanta-background",
                mouseControls: true,
                touchControls: true,
                gyroControls: false,
                minHeight: 200.00,
                minWidth: 200.00,
                scale: 1.00,
                scaleMobile: 1.00,
                color: 0x70f
            });

            // Handle tab visibility changes
            document.addEventListener('visibilitychange', () => {
                if (!document.hidden && !window.vantaEffect) {
                    // Reinitialize if coming back to the tab and effect is destroyed
                    initVanta();
                }
            });

            // Throttle resize events
            let resizeTimeout;
            window.addEventListener('resize', () => {
                if (resizeTimeout) clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    if (window.vantaEffect) {
                        window.vantaEffect.resize();
                    }
                }, 100);
            });
        }
    } catch (error) {
        console.error('Error loading Vanta:', error);
    }
}

// Initialize after page load
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initVanta);
} else {
    initVanta();
} 
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initVanta);
} else {
    initVanta();
} 